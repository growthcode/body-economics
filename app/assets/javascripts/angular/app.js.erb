var bodyEconomics = angular.module('bodyEconomics', []);

bodyEconomics.config(['$httpProvider', function($httpProvider){
  // read CSRF token
  token = $("meta[name=\"csrf-token\"]").attr("content")
  // include token in $httpProvider default headers
  $httpProvider.defaults.headers.common['X-CSRF-TOKEN'] = token
}]);

bodyEconomics.controller('DayCtrl', ['$scope', '$http', function($scope, $http){

  $scope.days = [];

  $http.get('/days')
  .success(function(data){
    $scope.user = data;
    $scope.days = data.days;
  })
  .error(function(xrh){
    console.log("in error callback")
  })

  $scope.updateScore = function(day) {
    $http.post('/days/' + day.id + '/update_score')
    .success(function(data){
      console.log("in success update function");
      day.score = data.day.score
    })
  }

  $scope.pointsPicture = function(score){
    switch (score) {
      case 1:
        return "<%= image_path 'one.png' %>";
      case 0:
        return "<%= image_path 'zero.png' %>";
      case -1:
        return "<%= image_path 'mOne.png' %>";
      case -2:
        return "<%= image_path 'mTwo.png' %>";
    }
  }
}])